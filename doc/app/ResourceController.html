<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />

  <title>Class: ResourceController</title>

  <link rel="stylesheet" href="./rdoc.css" type="text/css" media="screen" />

  <script src="./js/jquery.js" type="text/javascript" charset="utf-8"></script>
  <script src="./js/thickbox-compressed.js" type="text/javascript" charset="utf-8"></script>
  <script src="./js/quicksearch.js" type="text/javascript" charset="utf-8"></script>
  <script src="./js/darkfish.js" type="text/javascript" charset="utf-8"></script>

</head>
<body id="top" class="class">

  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="./index.html">Home</a>
          <a href="./index.html#classes">Classes</a>
          <a href="./index.html#methods">Methods</a>
        </h3>
      </div>
    </div>

    <div id="file-metadata">
      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul>
          
            <li><a href="./app/controllers/resource_controller_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="app/controllers/resource_controller.rb">app/controllers/resource_controller.rb</a></li>
          
          </ul>
        </div>
      </div>

      
    </div>

    <div id="class-metadata">
      
      <!-- Parent Class -->
      <div id="parent-class-section" class="section">
        <h3 class="section-header">Parent</h3>
        
        <p class="link"><a href="ApplicationController.html">ApplicationController</a></p>
        
      </div>
      

      

      

      
      <!-- Method Quickref -->
      <div id="method-list-section" class="section">
        <h3 class="section-header">Methods</h3>
        <ul class="link-list">
          
          <li><a href="#method-i-actual">#actual</a></li>
          
          <li><a href="#method-i-availability">#availability</a></li>
          
          <li><a href="#method-i-department_actual_totals2">#department_actual_totals2</a></li>
          
          <li><a href="#method-i-department_totals">#department_totals</a></li>
          
          <li><a href="#method-i-department_totals2">#department_totals2</a></li>
          
          <li><a href="#method-i-employee_view">#employee_view</a></li>
          
          <li><a href="#method-i-find_dr_offset">#find_dr_offset</a></li>
          
          <li><a href="#method-i-find_record_enter_actual">#find_record_enter_actual</a></li>
          
          <li><a href="#method-i-get_department_actuals">#get_department_actuals</a></li>
          
          <li><a href="#method-i-group_actuals_by_quarter">#group_actuals_by_quarter</a></li>
          
          <li><a href="#method-i-import">#import</a></li>
          
          <li><a href="#method-i-index">#index</a></li>
          
          <li><a href="#method-i-key_project_summary">#key_project_summary</a></li>
          
          <li><a href="#method-i-key_project_summary_new">#key_project_summary_new</a></li>
          
          <li><a href="#method-i-key_projects">#key_projects</a></li>
          
          <li><a href="#method-i-load_forecast_to_array">#load_forecast_to_array</a></li>
          
          <li><a href="#method-i-mda">#mda</a></li>
          
          <li><a href="#method-i-new_to_db">#new_to_db</a></li>
          
          <li><a href="#method-i-new_to_project_db">#new_to_project_db</a></li>
          
          <li><a href="#method-i-phuong">#phuong</a></li>
          
          <li><a href="#method-i-project_totals">#project_totals</a></li>
          
          <li><a href="#method-i-project_totals_wip">#project_totals_wip</a></li>
          
          <li><a href="#method-i-rule_check">#rule_check</a></li>
          
          <li><a href="#method-i-set_useful_globals">#set_useful_globals</a></li>
          
          <li><a href="#method-i-stack_data">#stack_data</a></li>
          
          <li><a href="#method-i-test">#test</a></li>
          
          <li><a href="#method-i-update_record">#update_record</a></li>
          
          <li><a href="#method-i-variance">#variance</a></li>
          
          <li><a href="#method-i-write_record">#write_record</a></li>
          
        </ul>
      </div>
      

      
    </div>

    <div id="project-metadata">
      
      
      <div id="fileindex-section" class="section project-section">
        <h3 class="section-header">Files</h3>
        <ul>
        
          <li class="file"><a href="./doc/README_FOR_APP.html">README_FOR_APP</a></li>
        
        </ul>
      </div>
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class/Module Index
          <span class="search-toggle"><img src="./images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
        
          <li><a href="./AdminController.html">AdminController</a></li>
        
          <li><a href="./AdminHelper.html">AdminHelper</a></li>
        
          <li><a href="./ApplicationController.html">ApplicationController</a></li>
        
          <li><a href="./ApplicationHelper.html">ApplicationHelper</a></li>
        
          <li><a href="./CanController.html">CanController</a></li>
        
          <li><a href="./CanHelper.html">CanHelper</a></li>
        
          <li><a href="./CanMain.html">CanMain</a></li>
        
          <li><a href="./CanMainsController.html">CanMainsController</a></li>
        
          <li><a href="./CanMainsHelper.html">CanMainsHelper</a></li>
        
          <li><a href="./CanSub.html">CanSub</a></li>
        
          <li><a href="./CanSubsController.html">CanSubsController</a></li>
        
          <li><a href="./CanSubsHelper.html">CanSubsHelper</a></li>
        
          <li><a href="./CostController.html">CostController</a></li>
        
          <li><a href="./CostHelper.html">CostHelper</a></li>
        
          <li><a href="./Costing.html">Costing</a></li>
        
          <li><a href="./CostingsController.html">CostingsController</a></li>
        
          <li><a href="./CostingsHelper.html">CostingsHelper</a></li>
        
          <li><a href="./Device.html">Device</a></li>
        
          <li><a href="./DevicesController.html">DevicesController</a></li>
        
          <li><a href="./DevicesHelper.html">DevicesHelper</a></li>
        
          <li><a href="./DynamicDelegator.html">DynamicDelegator</a></li>
        
          <li><a href="./Finnance.html">Finnance</a></li>
        
          <li><a href="./Hello.html">Hello</a></li>
        
          <li><a href="./ImportController.html">ImportController</a></li>
        
          <li><a href="./ImportHelper.html">ImportHelper</a></li>
        
          <li><a href="./ImportResourceController.html">ImportResourceController</a></li>
        
          <li><a href="./ImportResourceHelper.html">ImportResourceHelper</a></li>
        
          <li><a href="./MainController.html">MainController</a></li>
        
          <li><a href="./MainHelper.html">MainHelper</a></li>
        
          <li><a href="./PomodoroController.html">PomodoroController</a></li>
        
          <li><a href="./PomodoroHelper.html">PomodoroHelper</a></li>
        
          <li><a href="./PriorityController.html">PriorityController</a></li>
        
          <li><a href="./PriorityHelper.html">PriorityHelper</a></li>
        
          <li><a href="./Project.html">Project</a></li>
        
          <li><a href="./ProjectsController.html">ProjectsController</a></li>
        
          <li><a href="./ProjectsHelper.html">ProjectsHelper</a></li>
        
          <li><a href="./Pto.html">Pto</a></li>
        
          <li><a href="./PtosController.html">PtosController</a></li>
        
          <li><a href="./PtosHelper.html">PtosHelper</a></li>
        
          <li><a href="./Resource.html">Resource</a></li>
        
          <li><a href="./ResourceController.html">ResourceController</a></li>
        
          <li><a href="./ResourceHelper.html">ResourceHelper</a></li>
        
          <li><a href="./ResourcesController.html">ResourcesController</a></li>
        
          <li><a href="./ResourcesHelper.html">ResourcesHelper</a></li>
        
          <li><a href="./Sa.html">Sa</a></li>
        
          <li><a href="./SasController.html">SasController</a></li>
        
          <li><a href="./SasFrontController.html">SasFrontController</a></li>
        
          <li><a href="./SasFrontHelper.html">SasFrontHelper</a></li>
        
          <li><a href="./SasHelper.html">SasHelper</a></li>
        
          <li><a href="./Setup.html">Setup</a></li>
        
          <li><a href="./SetupSyncController.html">SetupSyncController</a></li>
        
          <li><a href="./SetupSyncHelper.html">SetupSyncHelper</a></li>
        
          <li><a href="./SetupTester.html">SetupTester</a></li>
        
          <li><a href="./SetupsController.html">SetupsController</a></li>
        
          <li><a href="./SetupsHelper.html">SetupsHelper</a></li>
        
          <li><a href="./Target.html">Target</a></li>
        
          <li><a href="./TargetsController.html">TargetsController</a></li>
        
          <li><a href="./TargetsHelper.html">TargetsHelper</a></li>
        
          <li><a href="./Task.html">Task</a></li>
        
          <li><a href="./TasksController.html">TasksController</a></li>
        
          <li><a href="./TasksHelper.html">TasksHelper</a></li>
        
          <li><a href="./TestProg.html">TestProg</a></li>
        
          <li><a href="./TestProgsController.html">TestProgsController</a></li>
        
          <li><a href="./TestProgsHelper.html">TestProgsHelper</a></li>
        
          <li><a href="./User.html">User</a></li>
        
          <li><a href="./UserMailer.html">UserMailer</a></li>
        
          <li><a href="./UsersController.html">UsersController</a></li>
        
          <li><a href="./UsersHelper.html">UsersHelper</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div>

  <div id="documentation">
    <h1 class="class">ResourceController</h1>

    <div id="description" class="description">
      
    </div><!-- description -->

    
    
    
    <div id="5Buntitled-5D" class="documentation-section">
      

      

      

      

      <!-- Methods -->
      
      <div id="public-instance-method-details" class="method-section section">
        <h3 class="section-header">Public Instance Methods</h3>

      
        <div id="actual-method" class="method-detail ">
          <a name="method-i-actual"></a>

          
          <div class="method-heading">
            <span class="method-name">actual</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="actual-source">
<pre>
<span class="ruby-comment"># File app/controllers/resource_controller.rb, line 207</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">actual</span>
  <span class="ruby-identifier">start_date</span> = <span class="ruby-ivar">@today</span>.<span class="ruby-identifier">beginning_of_month</span>.<span class="ruby-identifier">months_ago</span>(<span class="ruby-value">3</span>)
  <span class="ruby-ivar">@key_projects</span> = <span class="ruby-constant">Project</span>.<span class="ruby-identifier">k_proj</span>
  <span class="ruby-ivar">@avf</span> = <span class="ruby-constant">Resource</span>.<span class="ruby-identifier">avf</span>(<span class="ruby-identifier">start_date</span>,<span class="ruby-value">3</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- actual-source -->
            
          </div>

          

          
        </div><!-- actual-method -->

      
        <div id="availability-method" class="method-detail ">
          <a name="method-i-availability"></a>

          
          <div class="method-heading">
            <span class="method-name">availability</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="availability-source">
<pre>
<span class="ruby-comment"># File app/controllers/resource_controller.rb, line 15</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">availability</span>
  <span class="ruby-ivar">@key</span> = <span class="ruby-constant">Resource</span>.<span class="ruby-identifier">forward_look_key</span>(<span class="ruby-ivar">@today</span>)
  <span class="ruby-ivar">@others</span> = <span class="ruby-constant">Resource</span>.<span class="ruby-identifier">forward_look_other</span>(<span class="ruby-ivar">@today</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- availability-source -->
            
          </div>

          

          
        </div><!-- availability-method -->

      
        <div id="department_actual_totals2-method" class="method-detail ">
          <a name="method-i-department_actual_totals2"></a>

          
          <div class="method-heading">
            <span class="method-name">department_actual_totals2</span><span
              class="method-args">(data)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="department_actual_totals2-source">
<pre>
<span class="ruby-comment"># File app/controllers/resource_controller.rb, line 291</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">department_actual_totals2</span>(<span class="ruby-identifier">data</span>)
  <span class="ruby-comment">#Department Totals</span>
  <span class="ruby-identifier">dept_totals</span> = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">17</span>,<span class="ruby-value">0</span>)
  <span class="ruby-comment">#count = data.count</span>
  <span class="ruby-comment">#puts count</span>
  <span class="ruby-comment">#total = Resource.department_total(@date_start,project, department)</span>
  <span class="ruby-comment">#unless count &lt; 15</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">data</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">nil?</span>
    <span class="ruby-value">0</span>.<span class="ruby-identifier">upto</span>(<span class="ruby-value">2</span>){
      <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">puts</span> <span class="ruby-string">'James '</span><span class="ruby-operator">+</span><span class="ruby-identifier">x</span>.<span class="ruby-identifier">to_s</span>
      <span class="ruby-keyword">unless</span> <span class="ruby-identifier">data</span>[<span class="ruby-identifier">x</span>].<span class="ruby-identifier">actual</span>.<span class="ruby-identifier">blank?</span>
        <span class="ruby-identifier">dept_totals</span>[<span class="ruby-identifier">x</span>] = <span class="ruby-identifier">data</span>[<span class="ruby-identifier">x</span>].<span class="ruby-identifier">actual</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-comment">#dept_totals[15] += data[x].actual  if  data[x].actual</span>
    }
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">dept_totals</span>[<span class="ruby-value">16</span>] = <span class="ruby-identifier">dept_totals</span>[<span class="ruby-value">15</span>]<span class="ruby-operator">/</span><span class="ruby-value">12</span>
  <span class="ruby-comment">#end</span>
  <span class="ruby-identifier">dept_totals</span>
  <span class="ruby-comment">#end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- department_actual_totals2-source -->
            
          </div>

          

          
        </div><!-- department_actual_totals2-method -->

      
        <div id="department_totals-method" class="method-detail ">
          <a name="method-i-department_totals"></a>

          
          <div class="method-heading">
            <span class="method-name">department_totals</span><span
              class="method-args">(project,department)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="department_totals-source">
<pre>
<span class="ruby-comment"># File app/controllers/resource_controller.rb, line 256</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">department_totals</span>(<span class="ruby-identifier">project</span>,<span class="ruby-identifier">department</span>)
  <span class="ruby-comment">#Department Totals</span>
  <span class="ruby-ivar">@date</span> = <span class="ruby-ivar">@today</span>
  <span class="ruby-identifier">dept_totals</span> = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">17</span>,<span class="ruby-value">0</span>)
  <span class="ruby-ivar">@date_start</span> = <span class="ruby-ivar">@date</span>.<span class="ruby-identifier">at_beginning_of_month</span>
  <span class="ruby-identifier">dummy</span> = <span class="ruby-constant">Resource</span>.<span class="ruby-identifier">department_detail</span>(<span class="ruby-ivar">@date_start</span>,<span class="ruby-identifier">project</span>, <span class="ruby-identifier">department</span>)
  <span class="ruby-identifier">count</span> = <span class="ruby-identifier">dummy</span>.<span class="ruby-identifier">count</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-identifier">count</span>
  <span class="ruby-identifier">total</span> = <span class="ruby-constant">Resource</span>.<span class="ruby-identifier">department_total</span>(<span class="ruby-ivar">@date_start</span>,<span class="ruby-identifier">project</span>, <span class="ruby-identifier">department</span>)
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">count</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">15</span>
    <span class="ruby-value">0</span>.<span class="ruby-identifier">upto</span>(<span class="ruby-value">14</span>){
      <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">dept_totals</span>[<span class="ruby-identifier">x</span>] = <span class="ruby-identifier">total</span>[<span class="ruby-identifier">x</span>].<span class="ruby-identifier">forecast</span>
      <span class="ruby-identifier">dept_totals</span>[<span class="ruby-value">15</span>] <span class="ruby-operator">+=</span> <span class="ruby-identifier">total</span>[<span class="ruby-identifier">x</span>].<span class="ruby-identifier">forecast</span>  <span class="ruby-keyword">if</span>  <span class="ruby-identifier">total</span>[<span class="ruby-identifier">x</span>].<span class="ruby-identifier">forecast</span>
    }
    <span class="ruby-identifier">dept_totals</span>[<span class="ruby-value">16</span>] = <span class="ruby-identifier">dept_totals</span>[<span class="ruby-value">15</span>]<span class="ruby-operator">/</span><span class="ruby-value">12</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">dept_totals</span>
  <span class="ruby-comment">#end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- department_totals-source -->
            
          </div>

          

          
        </div><!-- department_totals-method -->

      
        <div id="department_totals2-method" class="method-detail ">
          <a name="method-i-department_totals2"></a>

          
          <div class="method-heading">
            <span class="method-name">department_totals2</span><span
              class="method-args">(data)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="department_totals2-source">
<pre>
<span class="ruby-comment"># File app/controllers/resource_controller.rb, line 276</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">department_totals2</span>(<span class="ruby-identifier">data</span>)
  <span class="ruby-comment">#Department Totals</span>
  <span class="ruby-identifier">dept_totals</span> = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">17</span>,<span class="ruby-value">0</span>)
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">data</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">nil?</span>
    <span class="ruby-value">0</span>.<span class="ruby-identifier">upto</span>(<span class="ruby-value">14</span>){
      <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span>
      <span class="ruby-keyword">unless</span> <span class="ruby-identifier">data</span>[<span class="ruby-identifier">x</span>].<span class="ruby-identifier">forecast</span>.<span class="ruby-identifier">blank?</span>
        <span class="ruby-identifier">dept_totals</span>[<span class="ruby-identifier">x</span>] = <span class="ruby-identifier">data</span>[<span class="ruby-identifier">x</span>].<span class="ruby-identifier">forecast</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">dept_totals</span>[<span class="ruby-value">15</span>] <span class="ruby-operator">+=</span> <span class="ruby-identifier">data</span>[<span class="ruby-identifier">x</span>].<span class="ruby-identifier">forecast</span>  <span class="ruby-keyword">if</span>  <span class="ruby-identifier">data</span>[<span class="ruby-identifier">x</span>].<span class="ruby-identifier">forecast</span>
    }
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">dept_totals</span>[<span class="ruby-value">16</span>] = <span class="ruby-identifier">dept_totals</span>[<span class="ruby-value">15</span>]<span class="ruby-operator">/</span><span class="ruby-value">12</span>
  <span class="ruby-identifier">dept_totals</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- department_totals2-source -->
            
          </div>

          

          
        </div><!-- department_totals2-method -->

      
        <div id="employee_view-method" class="method-detail ">
          <a name="method-i-employee_view"></a>

          
          <div class="method-heading">
            <span class="method-name">employee_view</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="employee_view-source">
<pre>
<span class="ruby-comment"># File app/controllers/resource_controller.rb, line 202</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">employee_view</span>
  <span class="ruby-identifier">employee_name</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:name</span>]
  <span class="ruby-identifier">start_date</span> = <span class="ruby-ivar">@today</span>.<span class="ruby-identifier">beginning_of_month</span>
  <span class="ruby-ivar">@resources</span> = <span class="ruby-constant">Resource</span>.<span class="ruby-identifier">tasks_by</span>(<span class="ruby-identifier">employee_name</span>, <span class="ruby-identifier">start_date</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- employee_view-source -->
            
          </div>

          

          
        </div><!-- employee_view-method -->

      
        <div id="find_dr_offset-method" class="method-detail ">
          <a name="method-i-find_dr_offset"></a>

          
          <div class="method-heading">
            <span class="method-name">find_dr_offset</span><span
              class="method-args">(project)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="find_dr_offset-source">
<pre>
<span class="ruby-comment"># File app/controllers/resource_controller.rb, line 467</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">find_dr_offset</span>(<span class="ruby-identifier">project</span>)
  <span class="ruby-identifier">dr_month_array</span> = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">5</span>)
  <span class="ruby-comment">#today = Date.today</span>
  <span class="ruby-identifier">beginning_of_month</span> = <span class="ruby-ivar">@today</span>.<span class="ruby-identifier">beginning_of_month</span>
  <span class="ruby-identifier">dr5_m</span> = <span class="ruby-identifier">project</span>.<span class="ruby-identifier">dr5</span>.<span class="ruby-identifier">beginning_of_month</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">project</span>.<span class="ruby-identifier">dr5</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">dr4_m</span> = <span class="ruby-identifier">project</span>.<span class="ruby-identifier">dr4</span>.<span class="ruby-identifier">beginning_of_month</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">project</span>.<span class="ruby-identifier">dr4</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">dr3_m</span> = <span class="ruby-identifier">project</span>.<span class="ruby-identifier">dr3</span>.<span class="ruby-identifier">beginning_of_month</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">project</span>.<span class="ruby-identifier">dr3</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">dr2_m</span> = <span class="ruby-identifier">project</span>.<span class="ruby-identifier">dr2</span>.<span class="ruby-identifier">beginning_of_month</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">project</span>.<span class="ruby-identifier">dr2</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">dr1_m</span> = <span class="ruby-identifier">project</span>.<span class="ruby-identifier">dr1</span>.<span class="ruby-identifier">beginning_of_month</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">project</span>.<span class="ruby-identifier">dr1</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span>

  <span class="ruby-value">0</span>.<span class="ruby-identifier">upto</span>(<span class="ruby-value">14</span>) {
    <span class="ruby-operator">|</span><span class="ruby-identifier">m</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">projected_date</span> = <span class="ruby-identifier">beginning_of_month</span>.<span class="ruby-identifier">months_since</span>(<span class="ruby-identifier">m</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">dr5_m</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">projected_date</span>
      <span class="ruby-identifier">dr_month_array</span>[<span class="ruby-value">4</span>]=<span class="ruby-identifier">m</span>
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">dr4_m</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">projected_date</span>
      <span class="ruby-identifier">dr_month_array</span>[<span class="ruby-value">3</span>]=<span class="ruby-identifier">m</span>
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">dr3_m</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">projected_date</span>
      <span class="ruby-identifier">dr_month_array</span>[<span class="ruby-value">2</span>]=<span class="ruby-identifier">m</span>
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">dr2_m</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">projected_date</span>
      <span class="ruby-identifier">dr_month_array</span>[<span class="ruby-value">1</span>]=<span class="ruby-identifier">m</span>
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">dr1_m</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">projected_date</span>
      <span class="ruby-identifier">dr_month_array</span>[<span class="ruby-value">0</span>]=<span class="ruby-identifier">m</span>
    <span class="ruby-keyword">end</span>
  }
  <span class="ruby-identifier">dr_month_array</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- find_dr_offset-source -->
            
          </div>

          

          
        </div><!-- find_dr_offset-method -->

      
        <div id="find_record_enter_actual-method" class="method-detail ">
          <a name="method-i-find_record_enter_actual"></a>

          
          <div class="method-heading">
            <span class="method-name">find_record_enter_actual</span><span
              class="method-args">(date,dept,name,project,function,time)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="find_record_enter_actual-source">
<pre>
<span class="ruby-comment"># File app/controllers/resource_controller.rb, line 432</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">find_record_enter_actual</span>(<span class="ruby-identifier">date</span>,<span class="ruby-identifier">dept</span>,<span class="ruby-identifier">name</span>,<span class="ruby-identifier">project</span>,<span class="ruby-identifier">function</span>,<span class="ruby-identifier">time</span>)
  <span class="ruby-identifier">record</span> = <span class="ruby-constant">Resource</span>.<span class="ruby-identifier">update_actual</span>(<span class="ruby-identifier">date</span>,<span class="ruby-identifier">dept</span>,<span class="ruby-identifier">name</span>,<span class="ruby-identifier">project</span>,<span class="ruby-identifier">function</span>)
  <span class="ruby-comment">#puts record.count</span>
  <span class="ruby-comment">#puts record.id</span>
  <span class="ruby-comment">#puts record.name</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">time</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">time</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">record</span>.<span class="ruby-identifier">actual</span> = <span class="ruby-identifier">time</span>
  <span class="ruby-identifier">record</span>.<span class="ruby-identifier">save</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- find_record_enter_actual-source -->
            
          </div>

          

          
        </div><!-- find_record_enter_actual-method -->

      
        <div id="get_department_actuals-method" class="method-detail ">
          <a name="method-i-get_department_actuals"></a>

          
          <div class="method-heading">
            <span class="method-name">get_department_actuals</span><span
              class="method-args">( date,project, department, team, filter)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="get_department_actuals-source">
<pre>
<span class="ruby-comment"># File app/controllers/resource_controller.rb, line 314</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">get_department_actuals</span>( <span class="ruby-identifier">date</span>,<span class="ruby-identifier">project</span>, <span class="ruby-identifier">department</span>, <span class="ruby-identifier">team</span>, <span class="ruby-identifier">filter</span>)
  <span class="ruby-identifier">a</span> = <span class="ruby-constant">Resource</span>.<span class="ruby-identifier">department_total_actual_include</span>(<span class="ruby-identifier">date</span>, <span class="ruby-identifier">project</span>, <span class="ruby-identifier">department</span>, <span class="ruby-identifier">team</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">filter</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;include&quot;</span>
  <span class="ruby-identifier">a</span> = <span class="ruby-constant">Resource</span>.<span class="ruby-identifier">department_total_actual_not_include</span>(<span class="ruby-identifier">date</span>, <span class="ruby-identifier">project</span>, <span class="ruby-identifier">department</span>, <span class="ruby-identifier">team</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">filter</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;exclude&quot;</span>
  <span class="ruby-identifier">department_actual_totals2</span>(<span class="ruby-identifier">a</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- get_department_actuals-source -->
            
          </div>

          

          
        </div><!-- get_department_actuals-method -->

      
        <div id="group_actuals_by_quarter-method" class="method-detail ">
          <a name="method-i-group_actuals_by_quarter"></a>

          
          <div class="method-heading">
            <span class="method-name">group_actuals_by_quarter</span><span
              class="method-args">( dataset)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <h4>Finance stuff =====</h4>
            

            
            <div class="method-source-code" id="group_actuals_by_quarter-source">
<pre>
<span class="ruby-comment"># File app/controllers/resource_controller.rb, line 495</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">group_actuals_by_quarter</span>( <span class="ruby-identifier">dataset</span>)
  <span class="ruby-identifier">quarter_data</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">0</span>)
  <span class="ruby-identifier">dataset</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">d</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">hash_tag</span> = <span class="ruby-identifier">d</span>.<span class="ruby-identifier">project</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;, &quot;</span>
    <span class="ruby-identifier">hash_tag</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">d</span>.<span class="ruby-identifier">department</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;, &quot;</span>
    <span class="ruby-identifier">hash_tag</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">d</span>.<span class="ruby-identifier">date</span>.<span class="ruby-identifier">year</span>.<span class="ruby-identifier">to_s</span>
    <span class="ruby-identifier">hash_tag</span> <span class="ruby-operator">+=</span> <span class="ruby-string">&quot;-&quot;</span> <span class="ruby-operator">+</span> ((<span class="ruby-identifier">d</span>.<span class="ruby-identifier">date</span>.<span class="ruby-identifier">month</span><span class="ruby-operator">/</span><span class="ruby-value">4</span>)<span class="ruby-operator">+</span><span class="ruby-value">1</span>).<span class="ruby-identifier">to_s</span>
    <span class="ruby-identifier">quarter_data</span>[<span class="ruby-identifier">hash_tag</span>] <span class="ruby-operator">+=</span> <span class="ruby-identifier">d</span>.<span class="ruby-identifier">actual</span>
    <span class="ruby-identifier">puts</span> <span class="ruby-identifier">hash_tag</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">quarter_data</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- group_actuals_by_quarter-source -->
            
          </div>

          

          
        </div><!-- group_actuals_by_quarter-method -->

      
        <div id="import-method" class="method-detail ">
          <a name="method-i-import"></a>

          
          <div class="method-heading">
            <span class="method-name">import</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="import-source">
<pre>
<span class="ruby-comment"># File app/controllers/resource_controller.rb, line 322</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">import</span>
  <span class="ruby-comment">#initial variables</span>
  <span class="ruby-comment">#header = 0</span>
  <span class="ruby-comment">#filenames</span>
  <span class="ruby-comment">#import_file = &quot;import/2012q4.csv&quot;</span>
  <span class="ruby-identifier">puts</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;=============================================&quot;</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;CSV importer for Resource Allocation database&quot;</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Resource List Import tool&quot;</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;=============================================&quot;</span>
  <span class="ruby-comment">#import and stack data</span>
  <span class="ruby-comment">#delete database</span>
  <span class="ruby-constant">Resource</span>.<span class="ruby-identifier">delete_all</span>
  <span class="ruby-comment">#import_file = [&quot;import/2011q1.csv&quot;, &quot;import/2011q2.csv&quot;, &quot;import/2011q3.csv&quot;, &quot;import/2011q4.csv&quot;, &quot;import/2012q1.csv&quot;, &quot;import/2012q2.csv&quot;, &quot;import/2012q3.csv&quot;, &quot;import/2012q4.csv&quot;]</span>
  <span class="ruby-comment">#import_file = [&quot;import/2012q2.csv&quot;, &quot;import/2012q3.csv&quot;]</span>
  <span class="ruby-identifier">import_file</span> = [<span class="ruby-string">&quot;import/2013q4.csv&quot;</span>]
  <span class="ruby-identifier">now</span> = <span class="ruby-ivar">@today</span>
  <span class="ruby-identifier">import_file</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span>, <span class="ruby-identifier">index</span><span class="ruby-operator">|</span>
    <span class="ruby-ivar">@today</span> = <span class="ruby-identifier">now</span>.<span class="ruby-identifier">months_ago</span>(((<span class="ruby-identifier">import_file</span>.<span class="ruby-identifier">size</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>)<span class="ruby-operator">-</span><span class="ruby-identifier">index</span>)*<span class="ruby-value">3</span>)
    <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;Today is #{@today}&quot;</span>
    <span class="ruby-identifier">header</span> = <span class="ruby-value">0</span>
    <span class="ruby-ivar">@removal_date</span> = <span class="ruby-ivar">@today</span>.<span class="ruby-identifier">months_ago</span>(<span class="ruby-value">3</span>).<span class="ruby-identifier">beginning_of_month</span>
    <span class="ruby-constant">Resource</span>.<span class="ruby-identifier">remove_forecast</span>(<span class="ruby-ivar">@removal_date</span>)
    <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;Reading #{f} #{index}&quot;</span>
    <span class="ruby-identifier">arr_of_arrs</span> = <span class="ruby-constant">CSV</span>.<span class="ruby-identifier">read</span>(<span class="ruby-identifier">f</span>)
    <span class="ruby-identifier">arr_of_arrs</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span>
      <span class="ruby-comment">#puts x</span>
      <span class="ruby-identifier">stack_data</span>(<span class="ruby-identifier">x</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">header</span> <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>
      <span class="ruby-comment">#header = 1 if header == 0</span>
      <span class="ruby-identifier">header</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
      <span class="ruby-comment">#break if header == 5</span>
      <span class="ruby-identifier">puts</span> <span class="ruby-identifier">header</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">header</span><span class="ruby-operator">%</span><span class="ruby-value">20</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- import-source -->
            
          </div>

          

          
        </div><!-- import-method -->

      
        <div id="index-method" class="method-detail ">
          <a name="method-i-index"></a>

          
          <div class="method-heading">
            <span class="method-name">index</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="index-source">
<pre>
<span class="ruby-comment"># File app/controllers/resource_controller.rb, line 8</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">index</span>
  <span class="ruby-comment">#Work through projects</span>
  <span class="ruby-ivar">@key_projects</span> = <span class="ruby-constant">Project</span>.<span class="ruby-identifier">k_proj</span>(<span class="ruby-ivar">@today</span>)
  <span class="ruby-comment">#@project=&quot;SinbadEE&quot;</span>
  <span class="ruby-comment">#@project_totals = project_totals(@project)</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- index-source -->
            
          </div>

          

          
        </div><!-- index-method -->

      
        <div id="key_project_summary-method" class="method-detail ">
          <a name="method-i-key_project_summary"></a>

          
          <div class="method-heading">
            <span class="method-name">key_project_summary</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Key <a href="Project.html">Project</a> Summary</p>
            

            
            <div class="method-source-code" id="key_project_summary-source">
<pre>
<span class="ruby-comment"># File app/controllers/resource_controller.rb, line 77</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">key_project_summary</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:p_id</span>]
    <span class="ruby-identifier">p</span>=<span class="ruby-identifier">params</span>[<span class="ruby-value">:p_id</span>].<span class="ruby-identifier">to_i</span>
    <span class="ruby-ivar">@key_projects</span> = <span class="ruby-constant">Project</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">p</span>)
    <span class="ruby-identifier">project_name</span> = <span class="ruby-ivar">@key_projects</span>.<span class="ruby-identifier">project</span>
    <span class="ruby-identifier">project_name_long</span> = <span class="ruby-ivar">@key_projects</span>.<span class="ruby-identifier">long_name</span>
    <span class="ruby-ivar">@dr_month</span> = <span class="ruby-identifier">find_dr_offset</span>(<span class="ruby-ivar">@key_projects</span>)
    <span class="ruby-ivar">@project_totals</span> = <span class="ruby-identifier">project_totals</span>(<span class="ruby-ivar">@key_projects</span>.<span class="ruby-identifier">project</span>)
    <span class="ruby-ivar">@date</span> = <span class="ruby-ivar">@today</span>
    <span class="ruby-identifier">puts</span> <span class="ruby-ivar">@date</span>
    <span class="ruby-comment">#Get Department Totals - Forecast</span>
    <span class="ruby-identifier">layout</span> = <span class="ruby-constant">Resource</span>.<span class="ruby-identifier">department_total_include</span>(<span class="ruby-ivar">@date</span>, <span class="ruby-identifier">project_name</span>,[<span class="ruby-string">&quot;3101&quot;</span>,<span class="ruby-string">&quot;1370&quot;</span>,<span class="ruby-string">&quot;1390&quot;</span>,<span class="ruby-string">&quot;2610&quot;</span>],<span class="ruby-string">&quot;layout&quot;</span>)
    <span class="ruby-ivar">@layout</span> = <span class="ruby-identifier">department_totals2</span>(<span class="ruby-identifier">layout</span>)

    <span class="ruby-identifier">design</span> = <span class="ruby-constant">Resource</span>.<span class="ruby-identifier">department_total_not_include</span>(<span class="ruby-ivar">@date</span>, <span class="ruby-identifier">project_name</span>,[<span class="ruby-string">&quot;3101&quot;</span>,<span class="ruby-string">&quot;1370&quot;</span>,<span class="ruby-string">&quot;1390&quot;</span>,<span class="ruby-string">&quot;2610&quot;</span>],<span class="ruby-string">&quot;layout&quot;</span>)
    <span class="ruby-ivar">@design</span> = <span class="ruby-identifier">department_totals2</span>(<span class="ruby-identifier">design</span>)

    <span class="ruby-identifier">pe</span> = <span class="ruby-constant">Resource</span>.<span class="ruby-identifier">department_total_not_include</span>(<span class="ruby-ivar">@date</span>, <span class="ruby-identifier">project_name</span>,[<span class="ruby-string">&quot;3371&quot;</span>,<span class="ruby-string">&quot;1340&quot;</span>,<span class="ruby-string">&quot;3213&quot;</span>],<span class="ruby-string">&quot;test&quot;</span>)
    <span class="ruby-ivar">@pe</span> = <span class="ruby-identifier">department_totals2</span>(<span class="ruby-identifier">pe</span>)

    <span class="ruby-identifier">te</span> = <span class="ruby-constant">Resource</span>.<span class="ruby-identifier">department_total_include</span>(<span class="ruby-ivar">@date</span>, <span class="ruby-identifier">project_name</span>,[<span class="ruby-string">&quot;3371&quot;</span>,<span class="ruby-string">&quot;1340&quot;</span>,<span class="ruby-string">&quot;3213&quot;</span>],<span class="ruby-string">&quot;test&quot;</span>)
    <span class="ruby-ivar">@te</span> = <span class="ruby-identifier">department_totals2</span>(<span class="ruby-identifier">te</span>)

    <span class="ruby-ivar">@application</span> = <span class="ruby-identifier">department_totals</span>(<span class="ruby-identifier">project_name</span>,<span class="ruby-string">&quot;3209&quot;</span>)

    <span class="ruby-comment">#Get Department Totals - Actuals</span>
    <span class="ruby-ivar">@layout_actuals</span> = <span class="ruby-identifier">get_department_actuals</span>(<span class="ruby-ivar">@date</span>, <span class="ruby-identifier">project_name</span>,[<span class="ruby-string">&quot;3101&quot;</span>,<span class="ruby-string">&quot;1370&quot;</span>,<span class="ruby-string">&quot;1390&quot;</span>,<span class="ruby-string">&quot;2610&quot;</span>],<span class="ruby-string">&quot;layout&quot;</span>,<span class="ruby-string">&quot;include&quot;</span>)
    <span class="ruby-ivar">@design_actuals</span> = <span class="ruby-identifier">get_department_actuals</span>(<span class="ruby-ivar">@date</span>, <span class="ruby-identifier">project_name</span>, [ <span class="ruby-string">&quot;3101&quot;</span>, <span class="ruby-string">&quot;1370&quot;</span>, <span class="ruby-string">&quot;1390&quot;</span>,<span class="ruby-string">&quot;2610&quot;</span>], <span class="ruby-string">&quot;layout&quot;</span>, <span class="ruby-string">&quot;exclude&quot;</span>)
    <span class="ruby-ivar">@pe_actuals</span> = <span class="ruby-identifier">get_department_actuals</span>(<span class="ruby-ivar">@date</span>, <span class="ruby-identifier">project_name</span>,[<span class="ruby-string">&quot;3371&quot;</span>,<span class="ruby-string">&quot;1340&quot;</span>,<span class="ruby-string">&quot;3213&quot;</span>],<span class="ruby-string">&quot;test&quot;</span>,<span class="ruby-string">&quot;exclude&quot;</span>)
    <span class="ruby-ivar">@te_actuals</span> = <span class="ruby-identifier">get_department_actuals</span>(<span class="ruby-ivar">@date</span>, <span class="ruby-identifier">project_name</span>,[<span class="ruby-string">&quot;3371&quot;</span>,<span class="ruby-string">&quot;1340&quot;</span>,<span class="ruby-string">&quot;3213&quot;</span>],<span class="ruby-string">&quot;test&quot;</span>,<span class="ruby-string">&quot;include&quot;</span>)
    <span class="ruby-ivar">@application_actuals</span> = <span class="ruby-identifier">get_department_actuals</span>(<span class="ruby-ivar">@date</span>, <span class="ruby-identifier">project_name</span>, <span class="ruby-string">&quot;3209&quot;</span>, <span class="ruby-string">&quot;void&quot;</span>, <span class="ruby-string">&quot;exclude&quot;</span>)

    <span class="ruby-comment">#Determine maximum count on actuals for chart width</span>
    <span class="ruby-identifier">actuals_month_count</span> = <span class="ruby-value">3</span>


    <span class="ruby-comment">#Prepare GoogleCharts data</span>
    <span class="ruby-ivar">@chart_title</span> = <span class="ruby-string">&quot;Memory BU Resource Forecast for &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">project_name_long</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;: &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">project_name</span>

    <span class="ruby-ivar">@data</span> = <span class="ruby-identifier">mda</span>(<span class="ruby-identifier">actuals_month_count</span> <span class="ruby-operator">+</span> <span class="ruby-value">16</span>,<span class="ruby-value">7</span>)
    <span class="ruby-ivar">@data</span>[<span class="ruby-value">0</span>][<span class="ruby-value">0</span>] = <span class="ruby-string">'Month'</span>
    <span class="ruby-ivar">@data</span>[<span class="ruby-value">0</span>][<span class="ruby-value">1</span>] = <span class="ruby-string">'Layout'</span>
    <span class="ruby-ivar">@data</span>[<span class="ruby-value">0</span>][<span class="ruby-value">2</span>] = <span class="ruby-string">'Design'</span>
    <span class="ruby-ivar">@data</span>[<span class="ruby-value">0</span>][<span class="ruby-value">3</span>] = <span class="ruby-string">'PE'</span>
    <span class="ruby-ivar">@data</span>[<span class="ruby-value">0</span>][<span class="ruby-value">4</span>] = <span class="ruby-string">'TE'</span>
    <span class="ruby-ivar">@data</span>[<span class="ruby-value">0</span>][<span class="ruby-value">5</span>] = <span class="ruby-string">'Applications'</span>
    <span class="ruby-ivar">@data</span>[<span class="ruby-value">0</span>][<span class="ruby-value">6</span>] = <span class="ruby-string">'DR1 baseline'</span>

    <span class="ruby-comment">#load_forecast_to_array(@layout,1)</span>
    <span class="ruby-comment">#load_forecast_to_array(@design,2)</span>
    <span class="ruby-comment">#load_forecast_to_array(@pe,3)</span>
    <span class="ruby-comment">#load_forecast_to_array(@application,4)</span>

    <span class="ruby-comment">#horrible coding!!!</span>
    <span class="ruby-identifier">dr5_month</span> = <span class="ruby-ivar">@key_projects</span>.<span class="ruby-identifier">dr5</span>.<span class="ruby-identifier">month</span>.<span class="ruby-identifier">to_s</span>
    <span class="ruby-identifier">dr5_year</span> = <span class="ruby-ivar">@key_projects</span>.<span class="ruby-identifier">dr5</span>.<span class="ruby-identifier">year</span>.<span class="ruby-identifier">to_s</span>
    <span class="ruby-identifier">dr4_month</span> = <span class="ruby-ivar">@key_projects</span>.<span class="ruby-identifier">dr4</span>.<span class="ruby-identifier">month</span>.<span class="ruby-identifier">to_s</span>
    <span class="ruby-identifier">dr4_year</span> = <span class="ruby-ivar">@key_projects</span>.<span class="ruby-identifier">dr4</span>.<span class="ruby-identifier">year</span>.<span class="ruby-identifier">to_s</span>
    <span class="ruby-identifier">dr3_month</span> = <span class="ruby-ivar">@key_projects</span>.<span class="ruby-identifier">dr3</span>.<span class="ruby-identifier">month</span>.<span class="ruby-identifier">to_s</span>
    <span class="ruby-identifier">dr3_year</span> = <span class="ruby-ivar">@key_projects</span>.<span class="ruby-identifier">dr3</span>.<span class="ruby-identifier">year</span>.<span class="ruby-identifier">to_s</span>
    <span class="ruby-identifier">dr2_month</span> = <span class="ruby-ivar">@key_projects</span>.<span class="ruby-identifier">dr2</span>.<span class="ruby-identifier">month</span>.<span class="ruby-identifier">to_s</span>
    <span class="ruby-identifier">dr2_year</span> = <span class="ruby-ivar">@key_projects</span>.<span class="ruby-identifier">dr2</span>.<span class="ruby-identifier">year</span>.<span class="ruby-identifier">to_s</span>
    <span class="ruby-identifier">dr1_month</span> = <span class="ruby-ivar">@key_projects</span>.<span class="ruby-identifier">dr1</span>.<span class="ruby-identifier">month</span>.<span class="ruby-identifier">to_s</span>
    <span class="ruby-identifier">dr1_year</span> = <span class="ruby-ivar">@key_projects</span>.<span class="ruby-identifier">dr1</span>.<span class="ruby-identifier">year</span>.<span class="ruby-identifier">to_s</span>

    <span class="ruby-value">1</span>.<span class="ruby-identifier">upto</span>(<span class="ruby-value">15</span>){
      <span class="ruby-operator">|</span><span class="ruby-identifier">m</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">month</span> = <span class="ruby-ivar">@today</span>.<span class="ruby-identifier">months_since</span>(<span class="ruby-identifier">m</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>).<span class="ruby-identifier">month</span>.<span class="ruby-identifier">to_s</span>
      <span class="ruby-identifier">year</span> = (<span class="ruby-ivar">@today</span>.<span class="ruby-identifier">months_since</span>(<span class="ruby-identifier">m</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>).<span class="ruby-identifier">year</span> <span class="ruby-operator">-</span> <span class="ruby-value">2000</span> ).<span class="ruby-identifier">to_s</span>
      <span class="ruby-identifier">x_string</span> = <span class="ruby-identifier">month</span> <span class="ruby-operator">+</span> <span class="ruby-string">'-'</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">year</span>
      <span class="ruby-identifier">year</span> = (<span class="ruby-ivar">@today</span>.<span class="ruby-identifier">months_since</span>(<span class="ruby-identifier">m</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>).<span class="ruby-identifier">year</span>).<span class="ruby-identifier">to_s</span>

      <span class="ruby-identifier">x_string</span> = <span class="ruby-string">&quot;DR5&quot;</span> <span class="ruby-keyword">if</span> ((<span class="ruby-identifier">dr5_month</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">month</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">dr5_year</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">year</span>))
      <span class="ruby-identifier">x_string</span> = <span class="ruby-string">&quot;DR4&quot;</span> <span class="ruby-keyword">if</span> ((<span class="ruby-identifier">dr4_month</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">month</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">dr4_year</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">year</span>))
      <span class="ruby-identifier">x_string</span> = <span class="ruby-string">&quot;DR3&quot;</span> <span class="ruby-keyword">if</span> ((<span class="ruby-identifier">dr3_month</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">month</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">dr3_year</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">year</span>))
      <span class="ruby-identifier">x_string</span> = <span class="ruby-string">&quot;DR2&quot;</span> <span class="ruby-keyword">if</span> ((<span class="ruby-identifier">dr2_month</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">month</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">dr2_year</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">year</span>))
      <span class="ruby-identifier">x_string</span> = <span class="ruby-string">&quot;DR1&quot;</span> <span class="ruby-keyword">if</span> ((<span class="ruby-identifier">dr1_month</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">month</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">dr1_year</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">year</span>))

      <span class="ruby-ivar">@data</span>[<span class="ruby-identifier">actuals_month_count</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">m</span>][<span class="ruby-value">0</span>] = <span class="ruby-identifier">x_string</span>
      <span class="ruby-ivar">@data</span>[<span class="ruby-identifier">actuals_month_count</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">m</span>][<span class="ruby-value">1</span>] = (<span class="ruby-ivar">@layout</span>[<span class="ruby-identifier">m</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>]*<span class="ruby-value">100</span>).<span class="ruby-identifier">round</span> <span class="ruby-operator">/</span> <span class="ruby-value">100.0</span>
      <span class="ruby-ivar">@data</span>[<span class="ruby-identifier">actuals_month_count</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">m</span>][<span class="ruby-value">2</span>] = (<span class="ruby-ivar">@design</span>[<span class="ruby-identifier">m</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>]*<span class="ruby-value">100</span>).<span class="ruby-identifier">round</span> <span class="ruby-operator">/</span> <span class="ruby-value">100.0</span>
      <span class="ruby-ivar">@data</span>[<span class="ruby-identifier">actuals_month_count</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">m</span>][<span class="ruby-value">3</span>] = (<span class="ruby-ivar">@pe</span>[<span class="ruby-identifier">m</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>]*<span class="ruby-value">100</span>).<span class="ruby-identifier">round</span> <span class="ruby-operator">/</span> <span class="ruby-value">100.0</span>
      <span class="ruby-ivar">@data</span>[<span class="ruby-identifier">actuals_month_count</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">m</span>][<span class="ruby-value">4</span>] = (<span class="ruby-ivar">@te</span>[<span class="ruby-identifier">m</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>]*<span class="ruby-value">100</span>).<span class="ruby-identifier">round</span> <span class="ruby-operator">/</span> <span class="ruby-value">100.0</span>
      <span class="ruby-ivar">@data</span>[<span class="ruby-identifier">actuals_month_count</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">m</span>][<span class="ruby-value">5</span>] = (<span class="ruby-ivar">@application</span>[<span class="ruby-identifier">m</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>]*<span class="ruby-value">100</span>).<span class="ruby-identifier">round</span> <span class="ruby-operator">/</span> <span class="ruby-value">100.0</span>
    }
    <span class="ruby-value">1</span>.<span class="ruby-identifier">upto</span>(<span class="ruby-identifier">actuals_month_count</span>){
      <span class="ruby-operator">|</span><span class="ruby-identifier">m</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">offset</span> = <span class="ruby-identifier">actuals_month_count</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">m</span>

      <span class="ruby-identifier">month</span> = <span class="ruby-ivar">@today</span>.<span class="ruby-identifier">months_ago</span>(<span class="ruby-identifier">offset</span>).<span class="ruby-identifier">month</span>.<span class="ruby-identifier">to_s</span>
      <span class="ruby-identifier">year</span> = (<span class="ruby-ivar">@today</span>.<span class="ruby-identifier">months_ago</span>(<span class="ruby-identifier">offset</span>).<span class="ruby-identifier">year</span><span class="ruby-operator">-</span><span class="ruby-value">2000</span> ).<span class="ruby-identifier">to_s</span>
      <span class="ruby-identifier">x_string</span> = <span class="ruby-identifier">month</span> <span class="ruby-operator">+</span> <span class="ruby-string">'-'</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">year</span>
      <span class="ruby-identifier">year</span> = (<span class="ruby-ivar">@today</span>.<span class="ruby-identifier">months_ago</span>(<span class="ruby-identifier">offset</span>).<span class="ruby-identifier">year</span> ).<span class="ruby-identifier">to_s</span>

      <span class="ruby-identifier">x_string</span> = <span class="ruby-string">&quot;DR5&quot;</span> <span class="ruby-keyword">if</span> ((<span class="ruby-identifier">dr5_month</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">month</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">dr5_year</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">year</span>))
      <span class="ruby-identifier">x_string</span> = <span class="ruby-string">&quot;DR4&quot;</span> <span class="ruby-keyword">if</span> ((<span class="ruby-identifier">dr4_month</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">month</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">dr4_year</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">year</span>))
      <span class="ruby-identifier">x_string</span> = <span class="ruby-string">&quot;DR3&quot;</span> <span class="ruby-keyword">if</span> ((<span class="ruby-identifier">dr3_month</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">month</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">dr3_year</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">year</span>))
      <span class="ruby-identifier">x_string</span> = <span class="ruby-string">&quot;DR2&quot;</span> <span class="ruby-keyword">if</span> ((<span class="ruby-identifier">dr2_month</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">month</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">dr2_year</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">year</span>))
      <span class="ruby-identifier">x_string</span> = <span class="ruby-string">&quot;DR1&quot;</span> <span class="ruby-keyword">if</span> ((<span class="ruby-identifier">dr1_month</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">month</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">dr1_year</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">year</span>))

      <span class="ruby-ivar">@data</span>[<span class="ruby-identifier">m</span>][<span class="ruby-value">0</span>] = <span class="ruby-identifier">x_string</span>
      <span class="ruby-ivar">@data</span>[<span class="ruby-identifier">m</span>][<span class="ruby-value">1</span>] = (<span class="ruby-ivar">@layout_actuals</span>[<span class="ruby-identifier">m</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>]*<span class="ruby-value">100</span>).<span class="ruby-identifier">round</span> <span class="ruby-operator">/</span> <span class="ruby-value">100.0</span>
      <span class="ruby-ivar">@data</span>[<span class="ruby-identifier">m</span>][<span class="ruby-value">2</span>] = (<span class="ruby-ivar">@design_actuals</span>[<span class="ruby-identifier">m</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>]*<span class="ruby-value">100</span>).<span class="ruby-identifier">round</span> <span class="ruby-operator">/</span> <span class="ruby-value">100.0</span>
      <span class="ruby-ivar">@data</span>[<span class="ruby-identifier">m</span>][<span class="ruby-value">3</span>] = (<span class="ruby-ivar">@pe_actuals</span>[<span class="ruby-identifier">m</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>]*<span class="ruby-value">100</span>).<span class="ruby-identifier">round</span> <span class="ruby-operator">/</span> <span class="ruby-value">100.0</span>
      <span class="ruby-ivar">@data</span>[<span class="ruby-identifier">m</span>][<span class="ruby-value">4</span>] = (<span class="ruby-ivar">@te_actuals</span>[<span class="ruby-identifier">m</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>]*<span class="ruby-value">100</span>).<span class="ruby-identifier">round</span> <span class="ruby-operator">/</span> <span class="ruby-value">100.0</span>
      <span class="ruby-ivar">@data</span>[<span class="ruby-identifier">m</span>][<span class="ruby-value">5</span>] = (<span class="ruby-ivar">@application_actuals</span>[<span class="ruby-identifier">m</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>]*<span class="ruby-value">100</span>).<span class="ruby-identifier">round</span> <span class="ruby-operator">/</span> <span class="ruby-value">100.0</span>
      <span class="ruby-comment">#@data[m][5] = 2</span>

    }


    <span class="ruby-comment">#puts @data</span>


    <span class="ruby-comment">#Get Department Details</span>
    <span class="ruby-ivar">@all_details</span> = <span class="ruby-constant">Resource</span>.<span class="ruby-identifier">project_detail_name</span>(<span class="ruby-ivar">@today</span>.<span class="ruby-identifier">at_beginning_of_month</span>,<span class="ruby-ivar">@key_projects</span>.<span class="ruby-identifier">project</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- key_project_summary-source -->
            
          </div>

          

          
        </div><!-- key_project_summary-method -->

      
        <div id="key_project_summary_new-method" class="method-detail ">
          <a name="method-i-key_project_summary_new"></a>

          
          <div class="method-heading">
            <span class="method-name">key_project_summary_new</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="key_project_summary_new-source">
<pre>
<span class="ruby-comment"># File app/controllers/resource_controller.rb, line 36</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">key_project_summary_new</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:p_id</span>]
    <span class="ruby-identifier">p</span>=<span class="ruby-identifier">params</span>[<span class="ruby-value">:p_id</span>].<span class="ruby-identifier">to_i</span>
    <span class="ruby-ivar">@project</span> = <span class="ruby-constant">Project</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">p</span>)
    
    <span class="ruby-comment">#Get Project start month and end month to bound graph and datasets</span>
    <span class="ruby-ivar">@start</span> = <span class="ruby-constant">Resource</span>.<span class="ruby-identifier">project_first</span>(<span class="ruby-ivar">@project</span>.<span class="ruby-identifier">project</span>)
    <span class="ruby-ivar">@finish</span> = <span class="ruby-constant">Resource</span>.<span class="ruby-identifier">project_last</span>(<span class="ruby-ivar">@project</span>.<span class="ruby-identifier">project</span>)
    <span class="ruby-ivar">@duration</span> = (<span class="ruby-ivar">@finish</span>.<span class="ruby-identifier">month</span> <span class="ruby-operator">-</span> <span class="ruby-ivar">@start</span>.<span class="ruby-identifier">month</span>) <span class="ruby-operator">+</span> <span class="ruby-value">12</span> * (<span class="ruby-ivar">@finish</span>.<span class="ruby-identifier">year</span> <span class="ruby-operator">-</span> <span class="ruby-ivar">@start</span>.<span class="ruby-identifier">year</span>) <span class="ruby-operator">+</span> <span class="ruby-value">1</span>
    
    <span class="ruby-comment">#Query database for details, department totals, and project totals</span>
    <span class="ruby-ivar">@project_summary</span> = <span class="ruby-constant">Resource</span>.<span class="ruby-identifier">summary</span>(<span class="ruby-ivar">@project</span>.<span class="ruby-identifier">project</span>, <span class="ruby-ivar">@today</span>)
    <span class="ruby-comment">#@project_details = Resource.detail(@project.project, @today)</span>
    <span class="ruby-comment">#@project_department_summary = Resource.department_summary(@project.project)</span>
    
    <span class="ruby-comment">#load array with project_department_summary for graph</span>
    <span class="ruby-comment">##@graph_array = ???(@project_department_summary)</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- key_project_summary_new-source -->
            
          </div>

          

          
        </div><!-- key_project_summary_new-method -->

      
        <div id="key_projects-method" class="method-detail ">
          <a name="method-i-key_projects"></a>

          
          <div class="method-heading">
            <span class="method-name">key_projects</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Key <a href="Project.html">Project</a> Index</p>
            

            
            <div class="method-source-code" id="key_projects-source">
<pre>
<span class="ruby-comment"># File app/controllers/resource_controller.rb, line 30</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">key_projects</span>
  <span class="ruby-ivar">@key_projects</span> = <span class="ruby-constant">Project</span>.<span class="ruby-identifier">k_proj</span>(<span class="ruby-ivar">@today</span>)
  <span class="ruby-identifier">key_projects_total_hours</span> = <span class="ruby-constant">Resource</span>.<span class="ruby-identifier">total_forecast_man_hours</span>(<span class="ruby-ivar">@today</span>)
  <span class="ruby-ivar">@kp_total</span> = <span class="ruby-identifier">key_projects_total_hours</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">forecast</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- key_projects-source -->
            
          </div>

          

          
        </div><!-- key_projects-method -->

      
        <div id="load_forecast_to_array-method" class="method-detail ">
          <a name="method-i-load_forecast_to_array"></a>

          
          <div class="method-heading">
            <span class="method-name">load_forecast_to_array</span><span
              class="method-args">(department, index)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="load_forecast_to_array-source">
<pre>
<span class="ruby-comment"># File app/controllers/resource_controller.rb, line 195</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">load_forecast_to_array</span>(<span class="ruby-identifier">department</span>, <span class="ruby-identifier">index</span>)
  <span class="ruby-identifier">m</span>=<span class="ruby-value">1</span>
  <span class="ruby-identifier">department</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">d</span><span class="ruby-operator">|</span>
    <span class="ruby-ivar">@data</span>[<span class="ruby-identifier">actuals_month_count</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">m</span>][<span class="ruby-identifier">index</span>] = (<span class="ruby-identifier">d</span>[<span class="ruby-identifier">m</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>]*<span class="ruby-value">100</span>).<span class="ruby-identifier">round</span> <span class="ruby-operator">/</span> <span class="ruby-value">100.0</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- load_forecast_to_array-source -->
            
          </div>

          

          
        </div><!-- load_forecast_to_array-method -->

      
        <div id="new_to_db-method" class="method-detail ">
          <a name="method-i-new_to_db"></a>

          
          <div class="method-heading">
            <span class="method-name">new_to_db</span><span
              class="method-args">(date, dept, team, name, product_line, project, function, time)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Write the project.csv file to the project.db def
write_project_record(record)</p>

<pre>new_to_project_db(record[0], record[1],record[2],record[3],record[4],record[5],record[6],record[7])</pre>

<p>end</p>
            

            
            <div class="method-source-code" id="new_to_db-source">
<pre>
<span class="ruby-comment"># File app/controllers/resource_controller.rb, line 414</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">new_to_db</span>(<span class="ruby-identifier">date</span>, <span class="ruby-identifier">dept</span>, <span class="ruby-identifier">team</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">product_line</span>, <span class="ruby-identifier">project</span>, <span class="ruby-identifier">function</span>, <span class="ruby-identifier">time</span>)
  <span class="ruby-identifier">record</span> = <span class="ruby-constant">Resource</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">time</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">time</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">time</span>.<span class="ruby-identifier">to_f</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">0.05</span>)
    <span class="ruby-identifier">time</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">record</span>.<span class="ruby-identifier">date</span> = <span class="ruby-identifier">date</span>
  <span class="ruby-identifier">record</span>.<span class="ruby-identifier">name</span> = <span class="ruby-identifier">name</span>
  <span class="ruby-identifier">record</span>.<span class="ruby-identifier">department</span> = <span class="ruby-identifier">dept</span>
  <span class="ruby-identifier">record</span>.<span class="ruby-identifier">team</span> = <span class="ruby-identifier">team</span>.<span class="ruby-identifier">downcase</span>
  <span class="ruby-identifier">record</span>.<span class="ruby-identifier">project</span> = <span class="ruby-identifier">project</span>
  <span class="ruby-identifier">record</span>.<span class="ruby-identifier">function</span> = <span class="ruby-identifier">function</span>
  <span class="ruby-identifier">record</span>.<span class="ruby-identifier">actual</span> = <span class="ruby-value">0</span>
  <span class="ruby-identifier">record</span>.<span class="ruby-identifier">forecast</span> = <span class="ruby-identifier">time</span>
  <span class="ruby-identifier">record</span>.<span class="ruby-identifier">save</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- new_to_db-source -->
            
          </div>

          

          
        </div><!-- new_to_db-method -->

      
        <div id="new_to_project_db-method" class="method-detail ">
          <a name="method-i-new_to_project_db"></a>

          
          <div class="method-heading">
            <span class="method-name">new_to_project_db</span><span
              class="method-args">(project,key,tapeout,dr1,dr2,dr3,dr4,dr5)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="new_to_project_db-source">
<pre>
<span class="ruby-comment"># File app/controllers/resource_controller.rb, line 449</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">new_to_project_db</span>(<span class="ruby-identifier">project</span>,<span class="ruby-identifier">key</span>,<span class="ruby-identifier">tapeout</span>,<span class="ruby-identifier">dr1</span>,<span class="ruby-identifier">dr2</span>,<span class="ruby-identifier">dr3</span>,<span class="ruby-identifier">dr4</span>,<span class="ruby-identifier">dr5</span>)
  <span class="ruby-identifier">record</span> = <span class="ruby-constant">Project</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-identifier">record</span>.<span class="ruby-identifier">project</span> = <span class="ruby-identifier">project</span>
  <span class="ruby-identifier">record</span>.<span class="ruby-identifier">tapeout</span> = <span class="ruby-identifier">tapeout</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">key</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;Y&quot;</span>
    <span class="ruby-identifier">record</span>.<span class="ruby-identifier">key</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">record</span>.<span class="ruby-identifier">key</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">record</span>.<span class="ruby-identifier">dr1</span> = <span class="ruby-identifier">dr1</span>
  <span class="ruby-identifier">record</span>.<span class="ruby-identifier">dr2</span> = <span class="ruby-identifier">dr2</span>
  <span class="ruby-identifier">record</span>.<span class="ruby-identifier">dr3</span> = <span class="ruby-identifier">dr3</span>
  <span class="ruby-identifier">record</span>.<span class="ruby-identifier">dr4</span> = <span class="ruby-identifier">dr4</span>
  <span class="ruby-identifier">record</span>.<span class="ruby-identifier">dr5</span> = <span class="ruby-identifier">dr5</span>
  <span class="ruby-identifier">record</span>.<span class="ruby-identifier">save</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- new_to_project_db-source -->
            
          </div>

          

          
        </div><!-- new_to_project_db-method -->

      
        <div id="phuong-method" class="method-detail ">
          <a name="method-i-phuong"></a>

          
          <div class="method-heading">
            <span class="method-name">phuong</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="phuong-source">
<pre>
<span class="ruby-comment"># File app/controllers/resource_controller.rb, line 56</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">phuong</span>
  <span class="ruby-comment">#@npi_actuals = Finance.new</span>
  <span class="ruby-comment">#@npi_forecast = Finance.new</span>

  <span class="ruby-comment">#@base_year = Date.new( 2011, 1, 1)</span>
  <span class="ruby-ivar">@actuals</span> = <span class="ruby-constant">Resource</span>.<span class="ruby-identifier">all_actuals</span>
  <span class="ruby-ivar">@npi_actuals_quarerly</span> = <span class="ruby-identifier">group_actuals_by_quarter</span>( <span class="ruby-ivar">@actuals</span>)
  <span class="ruby-comment">#@npi_forecast_quarerly = Finance.new</span>

<span class="ruby-keyword">end</span></pre>
            </div><!-- phuong-source -->
            
          </div>

          

          
        </div><!-- phuong-method -->

      
        <div id="project_totals-method" class="method-detail ">
          <a name="method-i-project_totals"></a>

          
          <div class="method-heading">
            <span class="method-name">project_totals</span><span
              class="method-args">(project)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="project_totals-source">
<pre>
<span class="ruby-comment"># File app/controllers/resource_controller.rb, line 233</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">project_totals</span>(<span class="ruby-identifier">project</span>)
  <span class="ruby-comment">#Project Totals</span>
  <span class="ruby-identifier">project_totals</span> = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">17</span>,<span class="ruby-value">0</span>)
  <span class="ruby-ivar">@date_start</span> = <span class="ruby-ivar">@today</span>.<span class="ruby-identifier">at_beginning_of_month</span>
  <span class="ruby-identifier">dummy</span> = <span class="ruby-constant">Resource</span>.<span class="ruby-identifier">project_detail</span>(<span class="ruby-ivar">@date_start</span>,<span class="ruby-identifier">project</span>)
  <span class="ruby-identifier">count</span> = <span class="ruby-identifier">dummy</span>.<span class="ruby-identifier">count</span>
  <span class="ruby-comment">#puts count</span>
  <span class="ruby-comment">#puts dummy</span>
  <span class="ruby-identifier">total</span> = <span class="ruby-constant">Resource</span>.<span class="ruby-identifier">project_total</span>(<span class="ruby-ivar">@date_start</span>,<span class="ruby-identifier">project</span>)
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">count</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">15</span>
    <span class="ruby-value">0</span>.<span class="ruby-identifier">upto</span>(<span class="ruby-value">14</span>){
      <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span>
      <span class="ruby-keyword">unless</span> <span class="ruby-identifier">total</span>[<span class="ruby-identifier">x</span>].<span class="ruby-identifier">nil?</span>
        <span class="ruby-identifier">project_totals</span>[<span class="ruby-identifier">x</span>] = <span class="ruby-identifier">total</span>[<span class="ruby-identifier">x</span>].<span class="ruby-identifier">forecast</span>
        <span class="ruby-identifier">project_totals</span>[<span class="ruby-value">15</span>] <span class="ruby-operator">+=</span> <span class="ruby-identifier">total</span>[<span class="ruby-identifier">x</span>].<span class="ruby-identifier">forecast</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">puts</span> <span class="ruby-identifier">project_totals</span>[<span class="ruby-identifier">x</span>]
    }
    <span class="ruby-identifier">project_totals</span>[<span class="ruby-value">16</span>] = <span class="ruby-identifier">project_totals</span>[<span class="ruby-value">15</span>]<span class="ruby-operator">/</span><span class="ruby-value">12</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">project_totals</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- project_totals-source -->
            
          </div>

          

          
        </div><!-- project_totals-method -->

      
        <div id="project_totals_wip-method" class="method-detail ">
          <a name="method-i-project_totals_wip"></a>

          
          <div class="method-heading">
            <span class="method-name">project_totals_wip</span><span
              class="method-args">(project)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="project_totals_wip-source">
<pre>
<span class="ruby-comment"># File app/controllers/resource_controller.rb, line 213</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">project_totals_wip</span>(<span class="ruby-identifier">project</span>)
  <span class="ruby-comment">#Project Totals</span>
  <span class="ruby-comment">#project_totals = Array.new(17,0)</span>
  <span class="ruby-ivar">@date_start</span> = <span class="ruby-ivar">@today</span>.<span class="ruby-identifier">at_beginning_of_month</span>
  <span class="ruby-comment">#dummy = Resource.project_detail(@date_start,project)</span>
  <span class="ruby-comment">#count = dummy.count</span>
  <span class="ruby-comment">#puts count</span>
  <span class="ruby-comment">#puts dummy</span>
  <span class="ruby-identifier">total</span> = <span class="ruby-constant">Resource</span>.<span class="ruby-identifier">project_total</span>(<span class="ruby-ivar">@date_start</span>,<span class="ruby-identifier">project</span>)
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">count</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">15</span>
    <span class="ruby-value">0</span>.<span class="ruby-identifier">upto</span>(<span class="ruby-value">14</span>){
      <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">project_totals</span>[<span class="ruby-identifier">x</span>] = <span class="ruby-identifier">total</span>[<span class="ruby-identifier">x</span>].<span class="ruby-identifier">forecast</span>
      <span class="ruby-identifier">project_totals</span>[<span class="ruby-value">15</span>] <span class="ruby-operator">+=</span> <span class="ruby-identifier">total</span>[<span class="ruby-identifier">x</span>].<span class="ruby-identifier">forecast</span>
      <span class="ruby-identifier">puts</span> <span class="ruby-identifier">project_totals</span>[<span class="ruby-identifier">x</span>]
    }
    <span class="ruby-identifier">project_totals</span>[<span class="ruby-value">16</span>] = <span class="ruby-identifier">project_totals</span>[<span class="ruby-value">15</span>]<span class="ruby-operator">/</span><span class="ruby-value">12</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">project_totals</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- project_totals_wip-source -->
            
          </div>

          

          
        </div><!-- project_totals_wip-method -->

      
        <div id="rule_check-method" class="method-detail ">
          <a name="method-i-rule_check"></a>

          
          <div class="method-heading">
            <span class="method-name">rule_check</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="rule_check-source">
<pre>
<span class="ruby-comment"># File app/controllers/resource_controller.rb, line 23</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rule_check</span>
  <span class="ruby-ivar">@projects</span> = <span class="ruby-constant">Project</span>.<span class="ruby-identifier">not_k_proj</span>(<span class="ruby-ivar">@today</span>)
  <span class="ruby-ivar">@overbooked_forecast</span> = <span class="ruby-constant">Resource</span>.<span class="ruby-identifier">overbooked</span>
  <span class="ruby-ivar">@team_names</span> = <span class="ruby-constant">Resource</span>.<span class="ruby-identifier">team_names</span>
  <span class="ruby-comment">#@underbooked_forecast = Resource.overbooked</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- rule_check-source -->
            
          </div>

          

          
        </div><!-- rule_check-method -->

      
        <div id="stack_data-method" class="method-detail ">
          <a name="method-i-stack_data"></a>

          
          <div class="method-heading">
            <span class="method-name">stack_data</span><span
              class="method-args">(line)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="stack_data-source">
<pre>
<span class="ruby-comment"># File app/controllers/resource_controller.rb, line 360</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">stack_data</span>(<span class="ruby-identifier">line</span>)
  <span class="ruby-comment">#puts &quot;===&quot;</span>
  <span class="ruby-comment">#puts line[0].to_i(10)</span>
  <span class="ruby-comment">#puts &quot;===&quot;</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">line</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">nil?</span>
    <span class="ruby-keyword">unless</span> <span class="ruby-identifier">line</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">to_i</span>(<span class="ruby-value">10</span>) <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
      <span class="ruby-identifier">line</span>[<span class="ruby-value">5</span>].<span class="ruby-identifier">rstrip!</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">line</span>[<span class="ruby-value">6</span>].<span class="ruby-identifier">nil?</span>
        <span class="ruby-identifier">line</span>[<span class="ruby-value">6</span>] = <span class="ruby-string">&quot;none&quot;</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">write_record</span>(<span class="ruby-identifier">line</span>)
      <span class="ruby-identifier">update_record</span>(<span class="ruby-identifier">line</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- stack_data-source -->
            
          </div>

          

          
        </div><!-- stack_data-method -->

      
        <div id="test-method" class="method-detail ">
          <a name="method-i-test"></a>

          
          <div class="method-heading">
            <span class="method-name">test</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="test-source">
<pre>
<span class="ruby-comment"># File app/controllers/resource_controller.rb, line 19</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">test</span>
  <span class="ruby-ivar">@test</span> = <span class="ruby-constant">Resource</span>.<span class="ruby-identifier">test</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- test-source -->
            
          </div>

          

          
        </div><!-- test-method -->

      
        <div id="update_record-method" class="method-detail ">
          <a name="method-i-update_record"></a>

          
          <div class="method-heading">
            <span class="method-name">update_record</span><span
              class="method-args">(record)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="update_record-source">
<pre>
<span class="ruby-comment"># File app/controllers/resource_controller.rb, line 398</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">update_record</span>  (<span class="ruby-identifier">record</span>)
  <span class="ruby-identifier">date_start</span> = <span class="ruby-ivar">@today</span>.<span class="ruby-identifier">at_beginning_of_month</span> <span class="ruby-operator">-</span> <span class="ruby-value">3</span>.<span class="ruby-identifier">months</span>
  <span class="ruby-value">0</span>.<span class="ruby-identifier">upto</span>(<span class="ruby-value">2</span>){
    <span class="ruby-operator">|</span><span class="ruby-identifier">m</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">date_current</span>=<span class="ruby-identifier">date_start</span>.<span class="ruby-identifier">months_since</span>(<span class="ruby-identifier">m</span>)
    <span class="ruby-identifier">find_record_enter_actual</span>(<span class="ruby-identifier">date_current</span>,<span class="ruby-identifier">record</span>[<span class="ruby-value">0</span>], <span class="ruby-identifier">record</span>[<span class="ruby-value">3</span>],<span class="ruby-identifier">record</span>[<span class="ruby-value">5</span>],<span class="ruby-identifier">record</span>[<span class="ruby-value">6</span>],<span class="ruby-identifier">record</span>[<span class="ruby-identifier">m</span><span class="ruby-operator">+</span><span class="ruby-value">8</span>])
  }
<span class="ruby-keyword">end</span></pre>
            </div><!-- update_record-source -->
            
          </div>

          

          
        </div><!-- update_record-method -->

      
        <div id="variance-method" class="method-detail ">
          <a name="method-i-variance"></a>

          
          <div class="method-heading">
            <span class="method-name">variance</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="variance-source">
<pre>
<span class="ruby-comment"># File app/controllers/resource_controller.rb, line 67</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">variance</span>
  <span class="ruby-ivar">@variance</span> = <span class="ruby-constant">Resource</span>.<span class="ruby-identifier">variance</span>(<span class="ruby-ivar">@today</span>)
  <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span>
    <span class="ruby-identifier">format</span>.<span class="ruby-identifier">csv</span> { <span class="ruby-identifier">render</span> <span class="ruby-identifier">text</span><span class="ruby-operator">:</span> <span class="ruby-ivar">@variance</span>.<span class="ruby-identifier">to_csv</span> }
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- variance-source -->
            
          </div>

          

          
        </div><!-- variance-method -->

      
        <div id="write_record-method" class="method-detail ">
          <a name="method-i-write_record"></a>

          
          <div class="method-heading">
            <span class="method-name">write_record</span><span
              class="method-args">(record)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="write_record-source">
<pre>
<span class="ruby-comment"># File app/controllers/resource_controller.rb, line 378</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">write_record</span>(<span class="ruby-identifier">record</span>)
  <span class="ruby-comment">#puts record</span>
  <span class="ruby-comment">#write new record to database</span>
  <span class="ruby-identifier">date_start</span> = <span class="ruby-ivar">@today</span>.<span class="ruby-identifier">at_beginning_of_month</span> <span class="ruby-operator">-</span> <span class="ruby-value">3</span>.<span class="ruby-identifier">months</span>
  <span class="ruby-value">11</span>.<span class="ruby-identifier">upto</span>(<span class="ruby-value">28</span>){
    <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span>
    <span class="ruby-comment">#work through forecast data</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">x</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">6</span>
      <span class="ruby-comment">#+print+ &quot;:Actual   &quot;</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-comment">#print &quot;:Forecast &quot;</span>
      <span class="ruby-identifier">date_current</span>=<span class="ruby-identifier">date_start</span>.<span class="ruby-identifier">months_since</span>(<span class="ruby-identifier">x</span><span class="ruby-operator">-</span><span class="ruby-value">11</span>)
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">record</span>[<span class="ruby-identifier">x</span>].<span class="ruby-identifier">nil?</span>
        <span class="ruby-identifier">record</span>[<span class="ruby-identifier">x</span>]=<span class="ruby-value">0</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">new_to_db</span>(<span class="ruby-identifier">date_current</span>, <span class="ruby-identifier">record</span>[<span class="ruby-value">0</span>],<span class="ruby-identifier">record</span>[<span class="ruby-value">1</span>], <span class="ruby-identifier">record</span>[<span class="ruby-value">3</span>], <span class="ruby-identifier">record</span>[<span class="ruby-value">4</span>], <span class="ruby-identifier">record</span>[<span class="ruby-value">5</span>], <span class="ruby-identifier">record</span>[<span class="ruby-value">6</span>],<span class="ruby-identifier">record</span>[<span class="ruby-identifier">x</span>])
    <span class="ruby-keyword">end</span>
  }
<span class="ruby-keyword">end</span></pre>
            </div><!-- write_record-source -->
            
          </div>

          

          
        </div><!-- write_record-method -->

      
      </div><!-- public-instance-method-details -->
    
      <div id="protected-instance-method-details" class="method-section section">
        <h3 class="section-header">Protected Instance Methods</h3>

      
        <div id="mda-method" class="method-detail ">
          <a name="method-i-mda"></a>

          
          <div class="method-heading">
            <span class="method-name">mda</span><span
              class="method-args">(width,height)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <h40></h40>

<h1>mda - make a multi-dimensional array =</h1>

<h40></h40>
            

            
            <div class="method-source-code" id="mda-source">
<pre>
<span class="ruby-comment"># File app/controllers/resource_controller.rb, line 525</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">mda</span>(<span class="ruby-identifier">width</span>,<span class="ruby-identifier">height</span>)
  <span class="ruby-identifier">a</span> = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">width</span>)
  <span class="ruby-identifier">a</span>.<span class="ruby-identifier">map!</span> { <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">height</span>,<span class="ruby-value">0</span>) }
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">a</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- mda-source -->
            
          </div>

          

          
        </div><!-- mda-method -->

      
        <div id="set_useful_globals-method" class="method-detail ">
          <a name="method-i-set_useful_globals"></a>

          
          <div class="method-heading">
            <span class="method-name">set_useful_globals</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="set_useful_globals-source">
<pre>
<span class="ruby-comment"># File app/controllers/resource_controller.rb, line 511</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">set_useful_globals</span>
  <span class="ruby-ivar">@auth</span> = <span class="ruby-identifier">session</span>[<span class="ruby-value">:user_auth</span>]
  <span class="ruby-ivar">@user_id</span>=<span class="ruby-identifier">session</span>[<span class="ruby-value">:user_id</span>]
  <span class="ruby-ivar">@full_name</span>=<span class="ruby-identifier">session</span>[<span class="ruby-value">:user_fullname</span>]
  <span class="ruby-identifier">now</span> = <span class="ruby-constant">Date</span>.<span class="ruby-identifier">today</span>.<span class="ruby-identifier">beginning_of_month</span>
  <span class="ruby-identifier">now_month</span> = (<span class="ruby-identifier">now</span>.<span class="ruby-identifier">month</span>) <span class="ruby-operator">-</span> <span class="ruby-value">1</span>
  <span class="ruby-identifier">now_offset</span> = <span class="ruby-identifier">now_month</span>.<span class="ruby-identifier">modulo</span>(<span class="ruby-value">3</span>)
  <span class="ruby-ivar">@today</span>=<span class="ruby-identifier">now</span>.<span class="ruby-identifier">months_ago</span>(<span class="ruby-identifier">now_offset</span>)
  <span class="ruby-ivar">@today</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-value">:long</span>)
  <span class="ruby-comment">#@today.beginning_of_month</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- set_useful_globals-source -->
            
          </div>

          

          
        </div><!-- set_useful_globals-method -->

      
      </div><!-- protected-instance-method-details -->
    
    </div><!-- 5Buntitled-5D -->
  

  </div><!-- documentation -->

  <div id="validator-badges">
    <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
    <p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
      Rdoc Generator</a> 2</small>.</p>
  </div>

</body>
</html>

